{% extends ../base.html %}

{% block meta %}
	<title>vision</title>
{% end %}

{% block static %}
	<script language="javascript" src="{{ static_url('js/jquery.uploadify.min.js') }}" type="text/javascript"></script>
	<script language="javascript" src="{{ static_url('js/jquery.live.js') }}" type="text/javascript"></script>
	<script src="{{ static_url('js/vision.js') }}" type="text/javascript"></script>
	<script src="{{ static_url('js/jquery.date.js') }}" type="text/javascript"></script>
	<script language="javascript" type="text/javascript">
		$(document).ready(function() {
			$("#poster").uploadify({
				swf				: '{{ static_url("js/uploadify.swf") }}',
				uploader		: '/a/image',
				checkExisting	: '/a/image/check',
				width			: '100',
				buttonText		: '上传头像',
				cancelImage		: '{{ static_url("img/uploadify-cancel.png") }}',
				auto			: true,
				fileObjName		: 'upload',
				onUploadSuccess : function (file, data, response) {
					$('#poster-disp').html('<span><input type="hidden" name="logo" value="'+data+'"/><img width=100 height=100 src="/image/attach/'+data+'_300"></span>');
					$('#poster_queue').hide();
				},
				onError			: function (event, queueID, fileObj){alert("文件:" + fileObj.name + " 上传失败");}
			});
			
			$('.censor, .preview').on('censorn', function(){
				var $that = $(this);
				
			})
		})
	</script>
	<link rel="stylesheet" type="text/css" href="{{ static_url('css/uploadify.css') }}"/>
	<link rel="stylesheet" type="text/css" href="{{ static_url('css/datepicker.css') }}"/>
{% end %}
{% block body %}
	<div class="span12">
		<br/><h3 class="pull-left">新建</h3><a class="btn pull-right" style="margin-right:10px;" onclick="return backconfirm(this);" href="/space/">返回工作室</a>
		<div style="clear:both;"></div>
		<hr/>
		<form class="form-horizontal" method="post" action="/volume/new/">
			<div class="span11 row3">
				<div class="control-group">
					<label class="control-label" for="maintype">类别</label>
					<div class="controls">
						<select type="text" class="span2" id="maintype" name="maintype">
							<option value="{% if maintype %}{{ maintype }}{% end %}">{% if maintype_cn %}{{ maintype_cn }}{% end %}</option>
						</select>
						<p class="help-inline">请选择类别</p>
					</div>
				</div>
				<div class="control-group">
					<label class="control-label" for="prop">属性</label>
					<div class="controls" >
						<select type="text" class="span2" id="prop" name="prop">
							<option value="{% if prop %}{{ prop }}{% end %}">{% if prop_cn %}{{ prop_cn }}{% end %}</option>
						</select>
						<p class="help-inline">请选择属性</p>
					</div>
				</div>
				<div class="control-group">
					<label class="control-label" for="subtype">二级属性</label>
					<div class="controls">
						<select type="text" class="span2" id="subtype" name="subtype">
							<option value="{% if subtype %}{{ subtype }}{% end %}">{% if subtype_cn %}{{ subtype_cn }}{% end %}</option>
						</select>
						<p class="help-inline">请选择二级属性</p>
					</div>
				</div>
			</div>
			<div style="clear:both;"></div>
			<hr/>
			
			<div class="span2">
				<div id="poster-disp">
					{% if logo %}
						<span><input type="hidden" name="logo" value="{{ logo }}"/><img width=100 height=100 src="/image/attach/{{ logo }}_100"></span>
					{% else %}
						<img src="http://placehold.it/100&text=No Pic" style="width:100px;height:100px;"/>
					{% end %}
				</div><br/>
				<div id="poster">头像上传</div>
			</div>
			
			<div class="span9">
				<div class="control-group">
					<label class="control-label" for="name">{% if prop=='PERSONAL' %}姓名{% else %}名称{% end %}</label>
					<div class="controls">
						<input type="text" class="input-xlarge" id="name" name="name" value="{% if name %}{{name}}{% end %}"/>
						<p class="help-inline">请输入{% if prop=='PERSONAL' %}姓名{% else %}名称{% end %}</p>
					</div>
				</div>
				
				<div class="control-group {% if prop=='PERSONAL' %}hide{% end %}">
					<label class="control-label" for="builder">负责人</label>
					<div class="controls">
						<input type="text" class="input-xlarge" id="builder" name="builder" value="{% if builder %}{{builder}}{% end %}"/>
						<p class="help-inline">请输入负责人</p>
					</div>
				</div>
				
				<div class="control-group {% if prop!='PERSONAL' %}hide{% end %}">
					<label class="control-label" for="male">性别</label>
					<div class="controls">
						<select type="text" class="input-xlarge" id="male" name="male">
							{% if male is None %}
								<option></option>
								<option value="male">男</option>
								<option value="female">女</option>
							{% elif male is True %}
								<option value="male">男</option>
								<option value="female">女</option>
							{% elif male is False %}
								<option value="female">女</option>
								<option value="male">男</option>
							{% end %}
						</select>
						<p class="help-inline">请选择性别</p>
					</div>
				</div>
				<div class="control-group">
					<label class="control-label" for="born">{% if prop=='PERSONAL' %}出生日期{% else %}创建时间{% end %}</label>
					<div class="controls">
						<script>select_birthday('born')</script>
						<p class="help-inline">请选择{% if prop=='PERSONAL' %}出生日期{% else %}创建时间{% end %}</p>
					</div>
				</div>
				<div class="control-group">
					<label class="control-label" for="live">国家地区:</label>
					<div class="controls">
						<script>select_pid("live", {% if live %}{{ live }}{% else %}1{% end %})</script>
					</div>
					<p class="help-inline">请选择国家地区</p>
				</div>
				<div class="control-group">
					<label class="control-label" for="agency">所属机构</label>
					<div class="controls">
						<input type="text" name="agency" class="input-xlarge" id="agency" value="{% if agency %}{{ agency }}{% end %}" />
						<p class="help-inline">请选择所属机构</p>
					</div>
				</div>
				<div class="control-group">
					<label class="control-label" for="website">网址</label>
					<div class="controls">
						<input type="text" class="input-xlarge" id="website" name="website" value="{% if website %}{{ website }}{% end %}"/>
						<p class="help-inline">请输入网址</p>
					</div>
				</div>
				<div class="control-group">
					<label class="control-label" for="grade">级别</label>
					<div class="controls">
						<span class="star-group">
							{% for i in xrange(0, 5) %}<i class="star icon-star-empty"></i>{% end %}
						</span>
						<input type="hidden" name="grade" class="star-value" value="{% if grade %}{{ grade }}{% end %}">
						<p class="help-inline">请选择级别</p>
					</div>
				</div>
				<div class="control-group">
					<label class="control-label" for="nexus">关系</label>
					<div class="controls">
						<span class="star-group">
							{% for i in xrange(0, 5) %}<i class="star icon-star-empty"></i>{% end %}
						</span>
						<input type="hidden" name="nexus" class="star-value" value="{% if nexus %}{{ nexus }}{% end %}">
						<p class="help-inline">请选择关系</p>
					</div>
				</div>
				<hr/>
				<div class="control-group {% if prop!='PERSONAL' %}hide{% end %}">
					<label class="control-label" for="intro">简介</label>
					<div class="controls">
						<textarea class="input-xlarge" id="intro" rows="3" name="intro">{% if intro %}{{ intro }}{% end %}</textarea>
						<p class="help-inline">请输入简介</p>
					</div>
				</div>
				<div class="control-group">
					<label class="control-label" for="about">相关机构</label>
					<div class="controls">
						<textarea class="input-xlarge" id="about" rows="3" name="about">{% if about %}{{ about }}{% end %}</textarea>
						<p class="help-inline">请输入相关机构</p>
					</div>
				</div>
				
				<div class="control-group {% if prop=='PERSONAL' %}hide{% end %}">
					<label class="control-label" for="market">市场投放</label>
					<div class="controls">
						<textarea class="input-xlarge" id="market" rows="3" name="market">{% if market %}{{ market }}{% end %}</textarea>
						<p class="help-inline">请输入市场投放</p>
					</div>
				</div>
				
				<input type="hidden" name="vid" value="{% if vid %}{{ vid }}{% end %}">
			</div>
			<div style="clear:both;"></div>
			<div class="span11">
				<div class="form-actions">
					<input type="submit" class="btn btn-primary censor" value="确定" />
					<a class="btn" href="/space/" onclick="return backconfirm(this);">取消</a>
				</div>
			</div>
		</form>
		<script src="{{ static_url('js/bootstrap-selectlist.js') }}" type="text/javascript"></script>
		<script src="{{ static_url('js/bootstrap-star.js') }}" type="text/javascript"></script>
		<script src="{{ static_url('js/bootstrap-checksubmit.js') }}" type="text/javascript"></script>
	</div>
{% end %}
